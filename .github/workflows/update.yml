name: Update TV Playlist

on:
  schedule:
    - cron: '0 */6 * * *'
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: |
          pip install playwright
          playwright install chromium

      - name: Run grabber
        env:
          LOGIN: ${{ secrets.LOGIN }}
          PASSWORD: ${{ secrets.PASSWORD }}
        run: python grabber.py
      
      # ИСПРАВЛЕННЫЙ ШАГ: Загрузка в Gist с использованием актуального действия
      - name: Deploy to Gist
        uses: exuanbo/actions-deploy-gist@v1
        with:
          token: ${{ secrets.GIST_TOKEN }} 
          gist_id: '11e73ac25d6d0d1fa234122ad0278cd8' 
          file_path: 'playlist_8f2d9k1l.m3u'
          gist_description: 'Автообновление плейлиста'
